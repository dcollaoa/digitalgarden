Let us consider the following case:

![image](https://academy.hackthebox.com/storage/modules/74/helping-out.png)

---

In this section, we will serve as domain administrators to Inlanefreight for a day. We have been tasked to help the IT department close some work orders, so we will be performing actions such as adding and removing users and groups, managing group policy, and more. Successful completion of the tasks can lead to us gaining a promotion to the Tier II IT team from the helpdesk.

---

## Connection Instructions

For this lab, you will have access to a domain-joined Windows server from which you can perform any actions needed to complete the lab. The environment will require you to RDP from Pwnbox or your own VM over VPN to the Windows server. Follow the steps below to utilize `RDP` and connect to the lab's Windows host.

- Click below in the `Questions` section to spawn the target host and obtain an IP address. The image below shows where to spawn the target and acquire a VPN key for the lab if needed.
    
    - IP ==
    - Username == `htb-student_adm`
    - Password == `Academy_student_DA!`
- We will use `xfreerdp` to connect with the target.
    
- Open a terminal in pwnbox or from your lab vm over vpn and enter the following command:
    
    - xfreerdp /v: /u:`htb-student_adm` /p:`Academy_student_DA!`

Once connected, open an MMC console, PowerShell, or the ADDS tools to begin.

---

## Tasks:

Attempt to complete the challenges on your own. If you get stuck, the `Solutions` dropdown below each task can help you. [This](https://docs.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2022-ps) reference on the Active Directory PowerShell module will be extremely helpful. As an introductory course on AD, we do not expect you to know everything about the topic and how to administer it. The Solutions below each task offer a step-by-step of how to complete the task. This section is provided to give you a taste of the daily tasks that AD administrators perform. Instead of providing the information to you in a static format, we have opted to provide it in a more hands-on manner.

### Task 1: Manage Users

Our first task of the day includes adding a few new-hire users into AD. We are just going to create them under the `"inlanefreight.local"` scope, drilling down into the `"Corp > Employees > HQ-NYC > IT "` folder structure for now. Once we create our other groups, we will move them into the new folders. You can utilize the Active Directory PowerShell module (New-ADUser), the Active Directory Users and Computers snap-in, or MMC to perform these actions.

#### Users to Add:

|**User**|
|---|
|`Andromeda Cepheus`|
|`Orion Starchaser`|
|`Artemis Callisto`|

Each user should have the following attributes set, along with their name:

|**Attribute**|
|---|
|`full name`|
|`email (first-initial.lastname@inlanefreight.local) ( ex. j.smith@inlanefreight.local )`|
|`display name`|
|`User must change password at next logon`|

Once we have added our new hires, take a quick second and remove a few old user accounts found in an audit that are no longer required.

#### Users to Remove

|**User**|
|---|
|`Mike O'Hare`|
|`Paul Valencia`|

Lastly `Adam Masters` has submitted a trouble ticket over the phone saying his account is locked because he typed his password wrong too many times. The helpdesk has verified his identity and that his Cyber awareness training is up to date. The ticket requests that you unlock his user account and force him to change his password at the next login.

![image](https://academy.hackthebox.com/storage/modules/74/troubleticket.png)

### Task 2: Manage Groups and Other Organizational Units

Next up for us is to create a new Security Group called `Analysts` and then add our new hires into the group. This group should also be nested in an OU named the same under the `IT` hive. The `New-ADOrganizationalUnit` PowerShell command should enable you to quickly add a new security group. We can also utilize the AD Users and Computers snap-in like in Task-1 to complete this task.

### Task 3: Manage Group Policy Objects

Next, we have been asked to duplicate the group policy `Logon Banner`, rename it `Security Analysts Control`, and modify it to work for the new Analysts OU. We will need to make the following changes to the Policy Object:

- we will be modifying the Password policy settings for users in this group and expressly allowing users to access PowerShell and CMD since their daily duties require it.
- For computer settings, we need to ensure the Logon Banner is applied and that removable media is blocked from access.

Once done, make sure the Group Policy is applied to the `Security Analysts` OU. This will require the use of the Group Policy Management snap-in found under `Tools` in the Server Manager window. For more of a challenge, the `Copy-GPO` cmdlet in PowerShell can also be utilized.

## Summary

This wraps it up for the first part of the guided lab. We covered how to manage users, groups, and Group Policy. In the next section, we will add a Computer to the INLANEFREIGHT domain, change the OU it exists in, ensuring that it is in the proper group to receive the Group Policy we created earlier.

---


